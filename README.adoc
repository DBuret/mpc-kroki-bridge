= MCP Kroki Bridge
David Buret <https://github.com/DBuret[@DBuret]>
:toc:
:icons: font
:docker-image: davidburet/mcp-kroki-bridge
:sectnums:
:toc:
:imagesdir: images



image:https://img.shields.io/docker/v/davidburet/mcp-kroki-bridge[Version]
image:https://img.shields.io/docker/image-size/davidburet/mcp-kroki-bridge/latest[Size]
image:https://img.shields.io/badge/Rust-2024-orange.svg[Rust Version]
image:https://img.shields.io/badge/Status-Concept-orange[Status]
image:https://img.shields.io/badge/License-MIT-blue.svg[License]


[cols="2,10",frame=none]
|===
|image:logo-128.png[logo]
|An implementation of the Model Context Protocol (MCP) that gives AI agents  access to https://kroki.io[Kroki] to render diagrams and data visualizations. Built with Rust for speed, reliability & minimal footprint.

Unlike standard MCP servers using stdio, this bridge operates over SSE (Server-Sent Events) with a Hybrid Response mode, making it compatible with local clients like LM Studio.

|===

toc::[]



== Features

* **Multiple Engines**: Supports Mermaid (not yet), PlantUML, Vega-Lite.
* **Smart Compression**: Uses Zlib + Base64 encoding to fit complex diagrams into URLs.
* **Network**: exposed with SSE and can be called  through network by LLM
* **Security**: Built from `scratch` with a non-root user. No OS vulnerabilities.

NOTE: Kroki is NOT included. This project is a gateway. Either start your own local Kroki instance or use https://kroki.io. I'm not affiliated with Kroki, please contact them before using their free service extensively - or better yet, start your own local instance and set `MCP_KROKI_URL`.

== Tools Included

=== `render_plantuml`
Render professional UML diagrams (classes, sequences, states) and C4 models with https://plantuml.com/en/[plantuml].

=== `render_vega`
The power of Data Visualization. Transform JSON data into beautiful charts (bars, lines, scatter plots) using https://vega.github.io/[Vega-Lite].

== Quick Start (Docker)

[source,bash]
----
docker run --rm -p 3001:3001 \
  -e MCP_KROKI_PORT="3001" \
  davidburet/mcp-kroki-bridge:latest
----

== Configuration for LM Studio

Add this to your `mcp.json` (usually in `~/.cache/lm-studio/mcp.json`):

[source,json]
----
{
  "mcpServers": {
    "mpc-kroki": {
      "url": "http://192.168.1.49:3001/sse"    
    }
  }
}
----

=== Example - Simple PlantUML diagram

 Create a UML sequence diagram showing the interaction between a user, a web server, and a database during login.


The LLM will automatically:

. Generate the PlantUML code
. Call the `generate_diagram` tool with type `plantuml`
. Return the generated SVG URL

=== Example - Vega-Lite chart

 Generate a bar chart comparing monthly sales: January 120, February 150, March 95, April 180


The LLM will:

. Build the Vega-Lite JSON spec
. Call the tool with type `vegalite`
. Return the SVG image

Next step is to connect your LLM with database or the web so it can provide usefull data to kroki

== Environment Variables

|===
| Variable | Description | Default

| `MCP_KROKI_URL` | Base URL of the Kroki instance | `https://kroki.io`
| `MCP_KROKI_PORT` | Listening port | `3001`
| `RUST_LOG` | Logging level (info, debug, warn) | `info`
|===

== License

MIT License. See `LICENSE` for details. **Note:** Mentioning the author in credits
is required for any redistribution.

== AI assistance disclosure

This project includes AI-assisted code and documentation.
The maintainer reviews and tests changes, however the software is provided "as is" and may contain errors.
Use at your own risk; validate in your environment before production use.

---
Created by DBuret. Part of the https://gitlab.com/dburet/pAItrimony[pAItrimony] services suite.